google.maps.Polygon.prototype.my_getBounds=function(){var a=new google.maps.LatLngBounds();this.getPath().forEach(function(c,b){a.extend(c);});return a;
};(function(e,h){var a,b;b=new google.maps.LatLng(37.544577320855815,127.02392578125);a=new google.maps.Map(document.getElementById("map"),{zoom:13,center:b,mapTypeId:google.maps.MapTypeId.ROADMAP,disableDoubleClickZoom:true});
var n=e("#SearchFormSpatial");var o=e("#SearchFormFormula");var j=e("#SearchFormAutocomplete");var f=null;var m=false;var l=null;var d=function(g){console.log(g);
if(m){return;}m=true;e.ajax({type:"GET",url:"http://localhost:5000/ajax/getPolygon",data:{formula:g},success:function(t){if(l!==null){if(l.length){for(var s=0,p=l.length;
s<p;s++){if(l[s].length){for(var r=0,q=l[s].length;r<q;r++){l[s][r].setMap(null);}}else{l[s].setMap(null);}}}else{l.setMap(null);}}h.mapp=a;h.foo=l=new GeoJSON(h.Geometry.text2geo(t.result));
console.log(h.Geometry.text2geo(t.result));if(l.type&&l.type=="Error"){return;}if(l.length){for(var s=0;s<l.length;s++){if(l[s].length){for(var r=0;r<l[s].length;
r++){l[s][r].setMap(a);if(l[s][r].geojsonProperties){setInfoWindow(l[s][r]);}}}else{l[s].setMap(a);}if(l[s].geojsonProperties){setInfoWindow(l[s]);}}}else{l.setMap(a);
if(l.geojsonProperties){setInfoWindow(l);}}m=false;}});};var i=function(){var s=n.find("div.group");var u="";for(var r=0,g=s.length;r<g;r++){var q=s.eq(r);
var p=q.find("input.spatial-name").data("idx");var t=q.find("select.spatial-operator").find("option:selected").val();u+=p;u+=t;if(t==="="){break;}}return u;
};var k=function(){d(i());};j.find("ul").on("click","li",function(){var g=e(this).data("idx");f.data("idx",g);f.val(e(this).data("name"));j.find("ul").empty();
k();});e("#SearchForm").bind("submit",function(g){g.preventDefault();e.ajax({type:"GET",url:"http://localhost:5000/ajax/searchResult",data:{operator:e("#SearchFormOperate").find("option:selected").val(),formula:i(),keyword:e("#SearchFormKeyword").val()},success:function(p){if(p.result==false){return;
}if(p.result.length==0){return;}console.log(p.result);}});});n.on("keyup","input",function(){f=e(this);var g=e(this).val();j.css("left",e(this).offset().left);
h.autocompleteSpatial(g);});var c=n.html();n.on("change","select",function(){var p=e(this).parent();k();if(e(this).find("option:selected").val()==="="){p.nextAll().addClass("hidden");
return;}if(p.next().length!==0){var g=p.next();while(true){g.removeClass("hidden");if(g.find("select.spatial-operator").find("option:selected").val()==="="){break;
}g=g.next();}return;}n.append(c);});})(jQuery,window);